<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agenda 2026</title>
<link rel="apple-touch-icon" href="/static/icons/192.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#1e1e1e">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-capable" content="yes">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="{{ url_for('static', filename='notegeli.css') }}" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
</head>

<body>
<div class="app-container">

    <!-- HEADER -->
    <div class="header-mini">
        <img src="{{ url_for('static', filename='icons/512.png') }}" class="logo-mini">
        <h5 class="title-mini">AGENDA <span class="fecha-mini">{{ fecha_larga }}</span>
       
    </div>

    <!-- MAÑANA -->
    {% if manana %}
    <div class="banner-manana">
        {% for m in manana %}
        <i class="bi bi-calendar-date"></i> Mañana — {{ m }}

        {% endfor %}
    </div>
    {% endif %}

    <!-- FORM -->
    <form method="POST" class="nuevo-form">
        <textarea name="texto" class="textarea" placeholder="Escribir nota..."></textarea>

        <div class="add-row">
            <button type="button" class="btn-cal-pick">
                 <i class="bi bi-calendar3"></i>
                </button>
                <span class="fecha-preview"></span>
                <input type="date" name="fecha" class="input-fecha-hidden">
                <button type="submit" class="btn-amber">Añadir</button>
        </div>
    </form>

    <!-- LISTA NOTAS -->
    <div class="notes-scroll">
    {% for n in notas %}
        <div class="nota-fila {{ 'nota-calendario' if n.tiempo.es_fecha else '' }}">
            <a href="/editar/{{ n.archivo }}" class="nota-link">
                <span class="tiempo-tag">
                    <i class="bi bi-calendar-date"></i> {{ n.tiempo.valor }}
                </span>
                <span class="nota-texto">{{ n.preview }}</span>
            </a>
            <a href="/borrar/{{ n.archivo }}" class="btn-delete">
                <i class="bi bi-trash3"></i>
            </a>
        </div>
    {% endfor %}
    </div>

</div>
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/service-worker.js");
}
</script>
<script>
const btn = document.querySelector(".btn-cal-pick");
const hidden = document.querySelector(".input-fecha-hidden");
const preview = document.querySelector(".fecha-preview");

btn.addEventListener("click", () => {
    hidden.showPicker(); // Chrome/Android va perfecto
});

hidden.addEventListener("change", () => {
    const v = hidden.value; // yyyy-mm-dd
    if (v) {
        const [yyyy,mm,dd] = v.split("-");
        preview.textContent = `${dd}/${mm}/${yyyy}`;
    } else {
        preview.textContent = "";
    }
});
</script>

</body>
</html>
