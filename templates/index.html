<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notegeli 2026</title>

    <link rel="manifest" href="/manifest.json">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='notegeli.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
</head>

<body class="container">

    <!-- Header -->
    <div class="header-mini">
        <img src="{{ url_for('static', filename='icons/512.png') }}" class="logo-mini">
        <h5 class="title-mini">AGENDA Geli>
    </div>

    <!-- Aviso mañana -->
    {% if manana %}
    <div class="alert-manana">
    {% for m in manana %}
        <div class="item">⏰ Mañana — {{ m }}</div>
    {% endfor %}
    </div>
    {% endif %}


    <!-- Añadir nota -->
    <form method="POST" class="add-box">
        <textarea name="texto" rows="4" placeholder="Escribir nota..." class="textarea"></textarea>


        <div class="add-row">
            <input type="date" name="fecha" class="date-input">
            <button type="submit" class="btn-amber">AÑADIR</button>
        </div>
    </form>

    <!-- Lista -->
    <div class="notes-wrapper-scroll">
        {% for n in notas %}
        <div class="nota-fila {{ 'nota-calendario' if n.tiempo.es_fecha else '' }}">
            <a href="/editar/{{ n.archivo }}" class="nota-link">
                <div class="tiempo-tag {{ 'text-primary' if n.tiempo.es_fecha else '' }}">
                    {{ n.tiempo.valor[5:] if n.tiempo.es_fecha else n.tiempo.valor }}
                </div>
                <div class="texto-principal">
                    {% if n.tiempo.es_fecha %}
                        {{ n.preview }}
                    {% else %}
                        <strong>{{ n.titulo }}</strong> - {{ n.preview[:30] }}
                    {% endif %}
                </div>
            </a>
            <a href="/borrar/{{ n.archivo }}" class="btn-delete"><i class="bi bi-trash3"></i></a>
        </div>
        {% endfor %}
    </div>

<script>
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/service-worker.js');
}
</script>
<script>
const ta = document.querySelector('textarea[name="texto"]');
if (ta) {
  ta.addEventListener('input', () => {
    ta.style.height = 'auto';
    ta.style.height = Math.min(ta.scrollHeight, 8 * 22) + 'px';
  });
}
</script>

</body>
</html>
